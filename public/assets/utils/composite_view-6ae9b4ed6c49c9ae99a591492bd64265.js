Backbone.CompositeView=Backbone.View.extend({addSubview:function(e,i){this.subviews(e).push(i),this.attachSubview(e,i.render())},attachSubview:function(e,i){this.$(e).append(i.$el),i.delegateEvents(),i.attachSubviews&&i.attachSubviews()},attachSubviews:function(){var e=this;this.subviews().each(function(i,t){e.$(t).empty(),i.each(function(i){e.attachSubview(t,i)})})},eachSubview:function(e){this.subviews().each(function(i,t){i.each(function(i){e(i,t)})})},onRender:function(){this.eachSubview(function(e){e.onRender&&e.onRender()})},remove:function(){Backbone.View.prototype.remove.call(this),this.eachSubview(function(e){e.remove()})},removeSubview:function(e,i){i.remove();var t=this.subviews(e);t.splice(t.indexOf(i),1)},removeModelSubview:function(e,i){var t=this.subviews(e),n=t.findIndex(function(e){return e.model===i});-1!==n&&(t.toArray()[n].remove(),t.splice(n,1))},subviews:function(e){return this._subviews=this._subviews||{},e?(this._subviews[e]=this._subviews[e]||_([]),this._subviews[e]):_(this._subviews)}});